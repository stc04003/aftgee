<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Least-Squares Estimators for Accelerated Failure Time Model • aftgee</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Least-Squares Estimators for Accelerated Failure Time Model">
<meta property="og:description" content="aftgee">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">aftgee</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/aftgee.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/aftsrr.html">Rank-based Estimators for Accelerated Failure Time Model</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/stc04003/aftgee/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="aftgee_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Least-Squares Estimators for Accelerated Failure Time Model</h1>
                        <h4 data-toc-skip class="author">Sy Han (Steven) Chiou</h4>
            
            <h4 data-toc-skip class="date">2022-05-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/stc04003/aftgee/blob/HEAD/vignettes/aftgee.Rmd" class="external-link"><code>vignettes/aftgee.Rmd</code></a></small>
      <div class="hidden name"><code>aftgee.Rmd</code></div>

    </div>

    
    
<p>In this vignette, we demonstrate the usage of the <code><a href="../reference/aftgee.html">aftgee()</a></code> function from the <strong><code>aftgee</code></strong> package<span class="citation">(Chiou, Kang, and Yan 2014a, 2014b)</span>. The vignette is based on <strong><code>aftgee</code></strong> version 1.1.7.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">library</span>(aftgee)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">packageVersion</span>(<span class="st">"aftgee"</span>)</span></code></pre></div>
<pre><code>[1] '1.1.7'</code></pre>
<div class="section level2">
<h2 id="aft-model">AFT model<a class="anchor" aria-label="anchor" href="#aft-model"></a>
</h2>
<p>The univariate semiparametric semiparametric accelerated failure time (AFT) model is specified as <span class="math display">\[\log(T_i) = X_i^\top\beta + \epsilon_i, i = 1, \ldots, n, \]</span> where <span class="math inline">\(T_i\)</span> is the failure time, <span class="math inline">\(X_i\)</span> is the <span class="math inline">\(p\times1\)</span> covariate vector, <span class="math inline">\(\beta\)</span> is the <span class="math inline">\(p\times1\)</span> regression coefficient, and <span class="math inline">\(\epsilon_i\)</span>’s are independent and identically distributed random variables with an unspecified distribution. In the presence of right censoring, the observed data are independent copies of <span class="math inline">\((Y_i, \Delta_i, X_i), i = 1, \ldots, n\)</span>, where <span class="math inline">\(Y_i = \min(T_i, C_i), \Delta_i = I(T_i &lt; C_i)\)</span>, and <span class="math inline">\(I(\cdot)\)</span> is the indicator function.</p>
</div>
<div class="section level2">
<h2 id="least-squares-estimator">Least-squares estimator<a class="anchor" aria-label="anchor" href="#least-squares-estimator"></a>
</h2>
<p>With survival data from right censoring, <span class="citation">Buckley and James (1979)</span> proposed a least-squares approach that replaces each response <span class="math inline">\(T_i\)</span> with the conditional expectation <span class="math inline">\(Y_i(\beta) = E_\beta(T_i|Y_i, \Delta_i, X_i)\)</span>. <!--The conditional expectation is defined as
$$\widehat{Y}_i(b) = \Delta_iY_i + (1 - \Delta_i)\left[\frac{\int_{e_i(b)}^\infty td\widehat{F}_{e_i(\beta)}(t)}{ 1 - \widehat{F}_{e_i(\beta)}\{e_i(\beta)\}} + X_i^\top b\right].$$ --> The theoretical properties of the Buckley and James estimator have been studied by <span class="citation">Ritov (1990)</span> and <span class="citation">Lai and Ying (1991)</span>. However, the Buckley and James estimator is rarely used in practice due to numerical challenges. <span class="citation">Jin, Lin, and Ying (2006)</span> proposed an iterative procedure to generalize the Buckley and James estimator, making the latter more practical. Recently, <span class="citation">Chiou et al. (2014)</span> embedded the generalized estimating equation (GEE) procedure to generalized the iterative procedure to accommodates within-cluster dependence in cluster survival data. The GEE embedded approach accounts for multivariate dependence through working correlation structures to improve efficiency. To illustrate the idea, we expand the notations to multivariate AFT model, <span class="math display">\[T_{ik} + X_{ik}^\top\beta + \epsilon_{ik}, i = 1, \ldots, n, k = 1, \ldots, K_i, \]</span> where <span class="math inline">\(K_i\)</span> is the <span class="math inline">\(i\)</span> cluster size, <span class="math inline">\(\beta\)</span> is an unknown <span class="math inline">\(p\times1\)</span> vector of regression parameters and the error terms, <span class="math inline">\(\epsilon_{i}= \{\epsilon_{i1}, \ldots, \epsilon_{iK_i}\}\)</span> are independent and identically distributed random variables with an unspecified distribution throughout clusters. In the presence of censoring, the observed data consists of copies of <span class="math inline">\(\{Y_{ik}, \Delta_{ik}, X_{ik}\}\)</span> for <span class="math inline">\(i = 1, \ldots, n\)</span>, and <span class="math inline">\(k = 1, \ldots, K_i\)</span>, where <span class="math inline">\(Y_{ik} = \min(T_{ik}, C_{ik})\)</span> and <span class="math inline">\(\Delta_{ik} = I(T_{ik} &lt; C_{ik})\)</span>.</p>
<p>Define <span class="math inline">\(\Omega_{i}^{-1}\big(\alpha(b)\big)\)</span> to be an <span class="math inline">\(K_i\times K_i\)</span> nonsingular working weight matrix that may involve additional working parameters <span class="math inline">\(\alpha\)</span> that depends on an initial value <span class="math inline">\(b\)</span> of <span class="math inline">\(\beta_0\)</span>. For <span class="math inline">\(i = 1, \ldots, n\)</span> and <span class="math inline">\(k = 1, \ldots, K_i\)</span>, let <span class="math inline">\(\widehat{\mathbf{Y}}_i(b)\)</span>, <span class="math inline">\(\mathbf{Y}_i\)</span>, <span class="math inline">\(\mathbf{T}_i\)</span>, <span class="math inline">\(\mathbf{C}_i\)</span> and <span class="math inline">\(\mathbf{\Delta}_i\)</span> be <span class="math inline">\(K_i\times 1\)</span> vector formed by stacking <span class="math inline">\(\widehat{Y}_{ik}(b)\)</span>, <span class="math inline">\(Y_{ik}\)</span>, <span class="math inline">\(C_{ik}\)</span> and <span class="math inline">\(\Delta_{ik}\)</span>, where <span class="math display">\[\begin{equation*}
  \widehat{Y}_{ik}(b) = \Delta_{ik}Y_{ik} + (1 - \Delta_{ik})
  \left[\frac{\int_{e_{ik}(b)}^\infty u \mathrm{d}\widehat{F}_{e_{ik}(\beta)}}{1 -
      \widehat{F}_{e_{ik}(\beta)}\{e_{ik}(b)\}} + X_{ik}^\top b \right].
\end{equation*}\]</span> A generalization of iterative least-square estimating equation is <span class="math display">\[\begin{equation}
  \label{equ:gee}
  U_{n, GEE}(\beta, b, \alpha) =
  \sum_{i=1}^n(\mathbf{X}_i - \bar{\mathbf{X}})^\top\Omega_i^{-1}\left\{\alpha(b)\right\}\{\widehat{\mathbf{Y}}_i(b) - \mathbf{X}_i\beta\} = 0,
\end{equation}\]</span> where <span class="math inline">\(\bar{\mathbf{X}}_i = \sum_{i=1}^n X_i / n\)</span>. Given <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(b\)</span>, the solution to <span class="math inline">\(U_{n, GEE}(\beta, b, \alpha) = 0\)</span> has a closed form <span class="math display">\[\begin{equation*}
  L_n(b, \alpha) =
  \left [ \sum_{i=1}^{n}(\mathbf{X}_{i}-\bar{\mathbf{X}})^{\top} \Omega_{i}^{-1}\big(\alpha(b)\big) (\mathbf{X}_{i}-\bar{\mathbf{X}}) \right ]^{-1}
  \left [ \sum_{i=1}^{n}(\mathbf{X}_{i}-\bar{X})^\top \Omega_{i}^{-1}\big(\alpha(b)\big)
    \left(\widehat{\mathbf{Y}}_{i}(b)-\bar{\mathbf{Y}}(b)\right)\right ],
\end{equation*}\]</span> where <span class="math inline">\(\bar{\mathbf{Y}}(b) = \sum_i^n\widehat{\mathbf{Y}}_i(b)/n\)</span>.</p>
<p>The GEE estimator, denoted by <span class="math inline">\(\widehat{\beta}_{n, GEE}\)</span>, can be obtained from an iterative procedure:</p>
<ol style="list-style-type: decimal">
<li>Obtain an initial estimate <span class="math inline">\(\widehat{\beta}^{(0)}_{n, GEE} = b_n\)</span> of <span class="math inline">\(\beta\)</span> and initialize with <span class="math inline">\(m = 1\)</span>.</li>
<li>Obtain an estimate <span class="math inline">\(\widehat\alpha_n\)</span> of <span class="math inline">\(\alpha\)</span> given <span class="math inline">\(\widehat\beta^{(m-1)}_{n, GEE}\)</span>, <span class="math inline">\(\widehat\alpha_n(\widehat{\beta}_{n, GEE}^{(m-1)})\)</span>.</li>
<li>Update with <span class="math inline">\(\widehat\beta^{(m)}_{n, GEE} = L_n\big(\widehat\beta^{(m-1)}_{n, GEE}, \widehat\alpha_n(\widehat\beta^{(m-1)}_{n, GEE})\big)\)</span>.</li>
<li>Increase <span class="math inline">\(m\)</span> by one and repeat 2 and 3 until convergence.</li>
</ol>
<p>The iteration proceeds with the aid of function  in  . The estimator reduces to the least squares estimator of  when the working weight matrix <span class="math inline">\(\Omega_i\)</span>’s are the identity matrix. We refer to  for more details. The working parameter estimate <span class="math inline">\(\widehat{\alpha}_n\)</span> does not affect the consistency of the GEE estimator, but may affect its efficiency. Higher efficiency can be achieved if <span class="math inline">\(\Omega_i\)</span> is closer to the covariance matrix of <span class="math inline">\(\widehat{\mathbf{Y}}_i(b)\)</span> and even an imperfect working weight still improves the efficiency . The variance of the estimator can again be estimated by resampling procedures.</p>
</div>
<div class="section level2">
<h2 id="the-aftgee-interface">The <code>aftgee()</code> interface<a class="anchor" aria-label="anchor" href="#the-aftgee-interface"></a>
</h2>
<p>The <code><a href="../reference/aftgee.html">aftgee()</a></code> is used to fit a semiparametric AFT model with rank-based approaches. The function interface of <code><a href="../reference/aftgee.html">aftgee()</a></code> is</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">args</span>(aftgee)</span></code></pre></div>
<pre><code><span class="kw">function</span> <span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, <span class="va">subset</span>, <span class="va">id</span> <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">contrasts</span> <span class="op">=</span> <span class="cn">NULL</span>, 
    <span class="va">weights</span> <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">margin</span> <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">corstr</span> <span class="op">=</span> <span class="st">"independence"</span>, <span class="va">binit</span> <span class="op">=</span> <span class="st">"srrgehan"</span>, 
    <span class="va">B</span> <span class="op">=</span> <span class="fl">100</span>, <span class="va">control</span> <span class="op">=</span> <span class="fu"><a href="../reference/aftgee.control.html">aftgee.control</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> 
<span class="cn">NULL</span></code></pre>
<p>The arguments are:</p>
<ul>
<li>
<code>formula</code>: a formula expression, of the form <code>response ~ predictors</code>. The <code>response</code> is a <code>Surv</code> object object with right censoring.</li>
<li>
<code>data</code>: an optional <code>data.frame</code> in which to interpret the variables occurring in the <code>formula</code>.</li>
<li>
<code>subset</code>: an optional vector specifying a subset of observations to be used in the fitting process.</li>
<li>
<code>id</code>: an optional vector used to identify the clusters. If missing, each individual row of <code>data</code> is presumed to represent a distinct subject.</li>
<li>
<code>contrasts</code>: an optional list.</li>
<li>
<code>weights</code>: an optional vector of observation weights.(This is still under development).</li>
<li>
<code>margin</code>: an optional vector to specify the margins; default at 1.</li>
<li>
<code>corstr</code>: a character string specifying the correlation structure. The following are permitted: <code>"independence"</code>, <code>"exchangeable"</code>, <code>"ar"</code>, <code>"unstructured"</code>, <code>"fixed"</code>.</li>
<li>
<code>binit</code>: an optional vector can be either a numeric vector or a character string specifying the initial slope estimator. When <code>binit</code> is a vector, its length should be the same as the dimension of covariates. When <code>binit</code> is a character string, it should be either <code>lm</code> for simple linear regression, or <code>srrgehan</code> for smoothed Gehan weight estimator. The default value is “srrgehan”.</li>
<li>
<code>B</code>: a numeric value specifies the resampling number. When <code>B = 0</code>, only the beta estimate will be displayed.</li>
<li>
<code>control</code>: controls maxiter and tolerance.</li>
</ul>
<p>In the uncensored case, <code><a href="../reference/aftgee.html">aftgee()</a></code> with independent working correlation structure will return an ordinary least squares estimate. In the multivariate case, efficiency can be improved in aftgee when the working correlation structure is close to the true correlation even in the absent of censoring.</p>
</div>
<div class="section level2">
<h2 id="an-simulated-example">An simulated example<a class="anchor" aria-label="anchor" href="#an-simulated-example"></a>
</h2>
<p>The following function generates simulated data following an AFT model <span class="math display">\[\log(T) = 2 + X_1 + X_2 + \epsilon, \]</span> where <span class="math inline">\(X_1\)</span> is a Bernoulli random variable with <span class="math inline">\(p = 0.5\)</span>, <span class="math inline">\(X_2\)</span> is a standard normal random variable, and <span class="math inline">\(\epsilon\)</span> is an independent standard normal random variable.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="op">&gt;</span><span class="st"> </span>datgen &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">n =</span> <span class="dv">100</span>, <span class="dt">tau =</span> <span class="fl">0.3</span>, <span class="dt">dim =</span> <span class="dv">2</span>) {</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="op">+</span><span class="st">   </span>x1 &lt;-<span class="st"> </span><span class="kw">rbinom</span>(dim <span class="op">*</span><span class="st"> </span>n, <span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="op">+</span><span class="st">   </span>x2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(dim <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="op">+</span><span class="st">   </span>e &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">t</span>(<span class="kw">exp</span>(MASS<span class="op">::</span><span class="kw">mvrnorm</span>(<span class="dt">n =</span> n, <span class="dt">mu =</span> <span class="kw">rep</span>(<span class="dv">0</span>, dim), <span class="dt">Sigma =</span> tau <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>tau) <span class="op">*</span><span class="st"> </span><span class="kw">diag</span>(dim)))))</span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="op">+</span><span class="st">   </span>tt &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2 <span class="op">+</span><span class="st"> </span>e)</span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="op">+</span><span class="st">   </span>cen &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="op">+</span><span class="st">   </span><span class="kw">data.frame</span>(<span class="dt">Time =</span> <span class="kw">pmin</span>(tt, cen), <span class="dt">status =</span> <span class="dv">1</span> <span class="op">*</span><span class="st"> </span>(tt <span class="op">&lt;</span><span class="st"> </span>cen),</span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="op">+</span><span class="st">              </span><span class="dt">x1 =</span> x1, <span class="dt">x2 =</span> x2, <span class="dt">id =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="dt">each =</span> dim))</span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="op">+</span><span class="st"> </span>}</span></code></pre></div>
<p>In <code>datgen()</code>, the error term <span class="math inline">\(\epsilon_i\)</span> follows a multivariate normal distribution with mean 0 and variance covariance matrix <span class="math inline">\((1 - \tau) I_{K_i} + \tau J_{K_i}\)</span>, where <span class="math inline">\(I_d\)</span> is the <span class="math inline">\(d\)</span>-dimensional identity matrix and <span class="math inline">\(J_d\)</span> is a <span class="math inline">\(d\times d\)</span> matrix of ones. The arguments <code>dim</code> controls the cluster size, <span class="math inline">\(K_i\)</span>. The observed data, <span class="math inline">\((Y, \Delta, X)\)</span>, correspond to <code>Time</code>, <code>status</code>, <code>x1</code>, and <code>x2</code>. The following gives an example a simulated data from an AFT model generated by <code>datgen()</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">set.seed</span>(<span class="dv">1</span>); <span class="kw">head</span>(dat &lt;-<span class="st"> </span><span class="kw">datgen</span>(<span class="dt">n =</span> <span class="dv">100</span>, <span class="dt">dim =</span> <span class="dv">2</span>))</span></code></pre></div>
<pre><code>       Time status x1          x2 id
1 11.801097      1  0 -0.62036668  1
2 68.486090      0  0  0.04211587  1
3  9.291650      1  1 -0.91092165  2
4 88.002129      1  1  0.15802877  2
5 11.835658      0  0 -0.65458464  3
6  3.910006      0  1  1.76728727  3</code></pre>
<p>The following fits the GEE embedded with independence and exchangeable correlation structures.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">system.time</span>(fit.ind &lt;-<span class="st"> </span><span class="kw">aftgee</span>(<span class="kw">Surv</span>(Time, status) <span class="op">~</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2, <span class="dt">data =</span> dat, <span class="dt">id =</span> id, <span class="dt">corstr =</span> <span class="st">"ind"</span>))</span></code></pre></div>
<pre><code>   user  system elapsed 
  3.972   0.012   3.987 </code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">summary</span>(fit.ind)</span></code></pre></div>
<pre><code>Call:
aftgee(formula = Surv(Time, status) ~ x1 + x2, data = dat, id = id, 
    corstr = "ind")

AFTGEE Estimator
            Estimate StdErr z.value   p.value    
(Intercept)    3.369  0.139  24.152 &lt; 2.2e-16 ***
x1             1.054  0.156   6.751 &lt; 2.2e-16 ***
x2             0.958  0.087  11.064 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">system.time</span>(fit.ex &lt;-<span class="st"> </span><span class="kw">update</span>(fit.ind, <span class="dt">corstr =</span> <span class="st">"ex"</span>))</span></code></pre></div>
<pre><code>   user  system elapsed 
  6.464   0.024   6.489 </code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">summary</span>(fit.ex)</span></code></pre></div>
<pre><code>Call:
aftgee(formula = Surv(Time, status) ~ x1 + x2, data = dat, id = id, 
    corstr = "ex")

AFTGEE Estimator
            Estimate StdErr z.value   p.value    
(Intercept)    3.369  0.123  27.396 &lt; 2.2e-16 ***
x1             1.055  0.141   7.497 &lt; 2.2e-16 ***
x2             0.960  0.082  11.774 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<p>The standard errors decrease slightly when the exchangeable correlation structure is specified over the independent correlation structure.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="reference">Reference<a class="anchor" aria-label="anchor" href="#reference"></a>
</h2>
<div id="refs" class="references hanging-indent">
<div id="ref-buckley1979linear">
<p>Buckley, Jonathan, and Ian James. 1979. “Linear Regression with Censored Data.” <em>Biometrika</em> 66 (3): 429–36.</p>
</div>
<div id="ref-chiou2014marginal">
<p>Chiou, Sy Han, Sangwook Kang, Junghi Kim, and Jun Yan. 2014. “Marginal Semiparametric Multivariate Accelerated Failure Time Model with Generalized Estimating Equations.” <em>Lifetime Data Analysis</em> 20 (4): 599–618.</p>
</div>
<div id="ref-R:aftgee">
<p>Chiou, Sy Han, Sangwook Kang, and Jun Yan. 2014a. “Fitting Accelerated Failure Time Models in Routine Survival Analysis with R Package aftgee.” <em>Journal of Statistical Software</em> 61 (11): 1–23. <a href="https://doi.org/10.18637/jss.v061.i11" class="external-link">https://doi.org/10.18637/jss.v061.i11</a>.</p>
</div>
<div id="ref-chiou2014fitting">
<p>———. 2014b. “Fitting Accelerated Failure Time Models in Routine Survival Analysis with R Package Aftgee.” <em>Journal of Statistical Software</em> 61 (11): 1–23.</p>
</div>
<div id="ref-jin2006least">
<p>Jin, Zhezhen, DY Lin, and Zhiliang Ying. 2006. “On Least-Squares Regression with Censored Data.” <em>Biometrika</em> 93 (1): 147–61.</p>
</div>
<div id="ref-lai1991large">
<p>Lai, Tze Leung, and Zhiliang Ying. 1991. “Large Sample Theory of a Modified Buckley-James Estimator for Regression Analysis with Censored Data.” <em>The Annals of Statistics</em>, 1370–1402.</p>
</div>
<div id="ref-ritov1990estimation">
<p>Ritov, Yaacov. 1990. “Estimation in a Linear Regression Model with Censored Data.” <em>The Annals of Statistics</em>, 303–28.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Sy Han Chiou, Sangwook Kang, Jun Yan.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
